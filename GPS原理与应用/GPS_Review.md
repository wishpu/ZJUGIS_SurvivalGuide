# 01 绪论

## 各大卫星系统的特点

|         |                             轨道                             |              卫星颗数              |    定位精度    |
| :-----: | :----------------------------------------------------------: | :--------------------------------: | :------------: |
|   GPS   | 6个轨道，每个轨道面相对地球赤道面倾角约55°，各轨道平面升交点的赤经相差60°。轨道平均高度20200km，卫星运行周期11小时58分钟 |        6×4=24颗（3颗备用）         |       6m       |          |
| GLONASS | 3个轨道，轨道平面倾角64.8°，高度19100km，运行周期11小时15分钟 |    21+3（现在有30+颗卫星在轨）     |      12m       |          |
| Galileo |             3个轨道，轨道面倾角56°，高度24126km              |                27+3                | 10m(无增强)→1m |          |
|  北斗   |                    3个轨道面（间隔120°）                     | 5(静止)+27(中轨道)+3(倾斜同步轨道) |      10m       |          |

- **GPS的特点**：地球上的任何地点、任何时刻至少有4颗卫星可供同时观测，且卫星信号的传播和接受不受天气影响，即GPS是一种**全球性、全天候的连续实时定位系统**；采用码分多址，大地坐标系(WGS-84)，世界协调时
- **GLONASS的特点**：采用频分多址体制，卫星之间靠不同频率来区分，每组频率的伪随机码相同，因此可以防止整个系统同时被敌方干扰，具有更强的抗干扰能力。坐标系采用原苏联地心坐标系(PZ-90)。时间系统与莫斯科标准时相关联
- **Galileo的特点**：在研制和组建的过程中，军方未直接参与，该系统是一个具有商业性质的民用卫星导航定位系统，非军方用户受到政治因素影响较小。在系统结构设计上进行了改进，以最大限度的保证系统的可靠性，并即时向指定用户提供系统的完备性信息。采用了更好的原子钟、部署了更多的监测站、在接收机中采用了噪声抑制技术，故用户能获得更高的导航精度、系统的服务面以及应用领域也更宽广。与GPS之间既保持相互独立、又互相兼容、具有互操作性
- **北斗的特点**：是一个军民两用的系统，主要功能包括快速定位、简短通信（120个汉字）和精密授时。采用了中国2000大地坐标系(CGS2000)；系统时间称为北斗时，属于原子时，其源头是中国的协调世界时，由国产原子钟进行计时；采用码分多址技术，在 L 波段和 S 波段发送导航信号；传输的信号分为“I”和“Q”两类，前者编码较短，可用于开放服务（民用），后者编码更长、且具有更强的抗干扰性，可用于需要授权的服务（军用）

### GPS系统的组成
- GPS系统主要由三大部分组成：空间星座部分、地面监测部分、用户设备部分
	- **空间星座部分**：24颗卫星提供星历和时间信息；发射伪距和载波信号；提供其他辅助信息
		- **GPS卫星的功能**：
			- 接受和储存由地面监控站发出的导航信息，接受并执行监控站发出的控制指令；
			- 进行部分必要的数据处理工作；
			- 通过星载铯钟和铷钟提供精密的时间标准，并向用户发送定位信息
	- **用户部分**：接受并观测卫星信号；记录和处理数据；提供导航定位信息
		- 用户接收机 = GPS接收机硬件 + 数据处理软件 + 微处理机和终端设备
		- 功能：
			- 硬件：获得必要的导航和定位信息及观测量，并经简单处理而实现实时导航和定位
			- 软件：对观测数据进行精加工(后处理)，以便获得精密定位结果
	- **地面控制部分**：中心控制系统；实现时间同步；跟踪卫星进行定轨
		- 监控站(5个)、主控站(1个)、注入站(3个)
		- **主控站的主要任务**：
			- 根据监测站所有观测资料计算并编制参数
			- 提供全球定位系统的时间基准
			- 调整偏离轨道的卫星
			- 必要时可以启用备用卫星，代替失效的工作卫星

## 卫星定位技术的特点：

- 观测站之间无需通视
- 定位精度高
- 观测时间短
- 提供三维坐标
- 操作简便
- 全天候作业



# 02 GPS定位的坐标系统及时间系统

## 天球坐标系的定义

### 天球的基本概念

- **天球**：以地球质心 $M$ 为中心，半径 $r$ 为任意长度的假想球体
- **天轴**：地球自转轴的延伸为天轴
- **天极**：天轴与天球的交点 $P_n$ 和 $P_s$ 称为天极
- **天球赤道面**：通过地球质心 $M$ 并与天轴垂直的平面（与地球赤道面重合）
- **天球赤道**：天球赤道面与天球相交的大圆（是一个半径任意大的圆——因为天球是一个半径为任意长度的假想球体）
- **天球子午面**：包含天轴并通过地球上任意点的平面
- **天球子午圈**：天球子午面与天球相交形成的大圆
- **时圈**：通过天轴的平面与天球相交的半个大圆
- **黄道**：地球公转的轨道面与天球相交的大圆
- **黄极**：通过天球中心且垂直于黄道面的直线与天球的交点称为黄极
- **春分点**：太阳在黄道上从天球南半球向北半球运行时，黄道与天球赤道的交点 $\gamma$ 
- **春分点和天球赤道面是建立参考系的重要基准点和基准面**

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191229102020026.png" alt="image-20191229102020026" style="zoom:67%;" />

### 天球坐标系

- **天球空间直角坐标系**：原点位于地球质心 $M$，$z$ 轴指向天球北极 $P_n$，$x$ 轴指向春分点 $\gamma$，$y$ 轴垂直于 $xMz$ 平面，与 $x$ 轴和 $z$ 轴构成右手坐标系统
- **天球球面坐标系**：球面中心与地球质心 $M$ 重合，赤经 $\alpha$ 为过春分点的天球子午面与过天体 $s$ 的天球子午面之间的夹角，赤纬 $\delta$ 为原点 $M$ 至天体 $s$ 的连线与天球赤道面之间的夹角，向径 $r$ 为原点 $M$ 至天体 $s$ 的距离。

<img src="E:\ZJU\GPS\Note\pictures\2-1.jpg" style="zoom:67%;" />

## 岁差

- 春分点在**黄道**上缓慢**西移** —— 岁差
- 成因：地球的形体接近于一个赤道隆起的椭球体，在日月引力和其他天体引力对地球隆起部分的作用下，地球自转方向发生改变 
- 地球自转轴在空间绕黄北极缓慢旋转（北天极上方观察为**顺时针**方向）→ 北天极以同样的方式绕黄北极旋转
- 只考虑日月引力的情况下，北天极将绕黄北极做半径为黄赤交角 $\epsilon$ ，周期为25800年的圆周运动。这种理想状态下做规则圆周运动的北天极被称为**瞬时平北天极**（简称**平北天极**）

## 章动

- 考虑到月球运行轨道和地月距离的变化，在日月引力等因素的影响下，实际上观测到的北天极（称为**瞬时北天极**）是绕着瞬时平北天极在做椭圆运动，这种情况称为章动
- 岁差、章动叠加后的轨迹类似正弦曲线，周期为18.6年

## 协议天球坐标系 → 协议地球坐标系

- **协议天球坐标系 / 协议惯性坐标系**：取某一瞬时作为标准历元 $t_0$，以此时的瞬时自转轴和地心至瞬时春分点的方向，经过该瞬时的岁差和章动改正后，分别作为 $z$ 轴和 $x$ 轴建立坐标系。

- 地球坐标系：两种表达形式——地球空间直角坐标系，大地坐标系

- **极移**：地球内部质量不均匀，导致自转轴在地球体内部运动，地极点在地球表面上的位置随时间变化

- **协议地球坐标系**：以地极点的平均位置作为基准点（**国际协议原点/CIO**）建立的地球坐标系。相应的赤道面称为**平赤道面/协议赤道面**

- 协议地球坐标系和协议天球坐标系的关联：

    - 原点都位于地球质心
    - 瞬时天球坐标系的 $z$ 轴与瞬时地球坐标系的 $Z$ 轴指向相同
    - 瞬时天球坐标系的 $x$ 轴与瞬时地球坐标系的 $X$ 轴指向不同，且其夹角为春分点的格林尼治恒星时

- 协议天球坐标系转换为协议地球坐标系
  $$
  \begin{align*}
    \bold{协议天球坐标系}&\xrightarrow{岁差、章动旋转}真天球坐标系(瞬时天球)\\
    &\xrightarrow{旋转真春分点时角}真地球坐标系(瞬时地球)\\
    &\xrightarrow{极移旋转}\bold{协议地球坐标系}\\
    \end{align*}
  $$


## 坐标系

### 高斯投影和UTM投影 (比较)

- 椭圆面上任一角度，投影到平面上后保持不变 (等角投影)
- 中央子午线投影为纵坐标轴，且是投影的对称轴
- **高斯投影的中央子午线长度变形 $m_0=1$，而UTM投影的长度变形 $m_0=0.9996$**

### WGS-84 坐标系

- 原点：地球质心 $M$
- $Z$ 轴：BIH1984.0 定义的协议地极CTP
- $X$ 轴：BIH1984.0 定义的零子午面与 CTP 相应的赤道的交点

## 时间

- 时间基准的要求：周期性、稳定性、复现性

- GPS采用的时间系统：恒星时、力学时、原子时

- **世界时系统**：以地球自转为基准，根据空间参考点不同可分为：恒星时、平太阳时、世界时

- **恒星时 / ST**：以春分点为参考点，由春分点的周日视运动所确定的时间

- **平太阳时 / MT**：假设一参考点（平太阳点）在天球赤道上以真太阳平均速度做周年视运动，并以此建立的时间

- **世界时 / UT**：以平子夜为零时起算的格林尼治平太阳时（恒星时和平太阳时都具有地方性）

- **原子时 / AT**：以物质内部原子运动的特征为基础的原子时系统，国际上平均各地原子钟，采用**国际原子时 / IAT**

- **力学时 / DT**：建立天体力学运动方程时采用的独立时间变量 $T$，可分为太阳系质心力学时和地球质心力学时

- **协调世界时 / UTC**：以原子时秒长为基础，在时刻上尽量接近于世界时的折中的时间系统

- **GPS时间系统 / GPST**：一种原子时，秒长与原子时相同，但是与IAT有不同的起点，即：
  	$$
    	IAT-GPST=19(s)
  $$

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191229101940363.png" alt="image-20191229101940363" style="zoom:67%;" />

### 时间性的重要意义
- GPS卫星位置不断变化：误差1cm=时间精度2.6*10^(-6)s
- 信号传播的时间需要精确测量：误差1cm=时间精度3*10^(-11)s
- 地球上点的天球坐标不断变化：误差1cm=时间精度2*10^(-5)s
- 只有在时间片足够小的情况下，才能假设卫星和地球静止，从而解方程得出结果



# 03卫星运动及GPS卫星信号

- 卫星受到的作用力分为两类：

    - 地球质心引力
    - **摄动力**：非中心引力（具体见后）
        - 太阳、月亮及其他天体引力
        - 大气阻力、太阳光压力、地球潮汐作用力

## 开普勒定律

- 开普勒第一定律：卫星运动的轨道是一个椭圆，其一焦点与地球的质心重合
	- 卫星绕地球质心运动的轨道方程：
		$$
		r=\frac{a_s(1-e_s^2)}{1+e_s cosf_s}
		$$
		其中 $r$ 为卫星的地心距离，$a_s$ 为轨道椭圆的长半轴，$e_s$ 为轨道椭圆的离心率，$f_s$ 为真近点角
	
- 

- 开普勒第三定律：卫星运行周期的平方，同轨道椭圆长半径的立方之比为一常量——地球引力常数的倒数：
    $$
    \frac{T_s^2}{a_s^3}=\frac{4\pi^2}{GM}
    $$
    

## 卫星轨道参数

- 开普勒轨道参数，用于描述卫星的无摄运动
- $a_s$：椭圆轨道的长半轴，轨道椭圆形状参数
- $e_s$：轨道椭圆的偏心率，轨道椭圆形状参数
- $\Omega$：升交点的赤经，轨道平面定向参数
- $i$：轨道面倾角，轨道平面定向参数
- $\omega_s$：近地点角距，轨道椭圆定向参数
- $f_s$：卫星的真近点角（轨道平面上卫星与近地点之间的地心角距），是一个以时间为参数的函数，确定了卫星在轨道上的瞬时位置

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191231092227779.png" alt="image-20191231092227779" style="zoom:80%;" />



## 卫星摄动力

### 摄动力种类

- 地球体的非球性及其质量分布不均匀而引起的作用力，即地球的非中心引力
- 太阳的引力、月球的引力
- 太阳光的直接与间接辐射压力
- 大气阻力（影响小）
- 地球潮汐的作用力（包括海洋和固体潮汐）
- 磁力及其他作用力

### 摄动力对卫星运动的影响

- 引起轨道平面在空间旋转，使升交点赤经 $\Omega$ 产生周期性变化
- 引起近地点在轨道平面内旋转，导致近地点角距 $\omega$ 的变化
- 引起平近点角 $M$ 的变化

### 日月引力对卫星运动的影响

- 导致卫星在3h弧段上，在径向、法向和切向上产生50~150m的位置误差
- 导致卫星在4h弧段上对轨道参数造成摄动量影响

## GPS卫星星历

### 什么是卫星星历
- 卫星星历是描述卫星运动轨道的信息，即是一组对应于某一时刻的卫星轨道根数及变率
- 根据卫星星历可以计算出任一时刻的卫星位置及其速度
- GPS卫星星历分为**预报星历（广播星历）**和**后处理星历（精密星历）**

### 什么是预报星历
- **预报星历是由卫星发射含有轨道信息的导航电文给用户，用户利用接收机直接接受并解码即可得到的星历**
- 预报星历包含根据监测站约一周的观测资料推算所得的相对某一参考历元的轨道参数和摄动改正项参数，即**参考星历**
- 通过轨道参数的摄动项对参考星历加以改正，可以外推出任意观测历元的卫星星历
- 预报星历每小时更新一次，参考历元如果选在两次更新的中央时刻，那么外推时间间隔最大不会超过0.5小时，能够更好的保证精度（一般约20～40m）
- 预报星历包含外推误差，不能满足精密定位的需求

### 什么是后处理星历
- **后处理星历是根据地面跟踪站所获得的精密观测资料计算得到的星历**
- 是一种不包含外推误差的实测星历，精度可达米级
- 用户无法实时通过接受卫星信号而获得，只能事后通过通讯媒体从服务商处获得
- 是一种有偿服务

## 伪随机码
- 具有类似随机码的良好的**自相关**特性，且具有某种确定的编码规则，便于人工复制（**可复制**）
- GPS卫星发射的测距码信号中包含了C/A码和P码两种伪随机噪声码

### 码的概念
- **码**：是一种表达信息的二进制数及其组合，是一组二进制的数码序列

- **码元**：某一特定时间长度内的码的组合

- **编码**：将各种信息按某种预定的规则，表示为二进制数的组合

- **数码率**：每秒钟传输的比特数

- **自相关函数**：两个码序列中，相同的码元个数为 $Su$，相异的码元个数为 $Du$，自相关函数即：
	$$
	R(t)=\frac{Su-Du}{Su+Du}
	$$
	
- 码序列完全对齐时，$R(t)=1$
	
- **信号调制**：使一种波形的某些特性按另一种波形或信号变化的过程或处理方法

- **信号解调**：从携带信息的已调信号中恢复消息的过程

### C/A码
- 由两个10级反馈移位寄存器组合产生
- **特点**：
	- 码长较短，易于捕获。而通过捕获C/A码所得到的信息，可以很方便的捕获P码，所以通常称C/A码为**捕获码**
	- 码元宽度较大，精度较低。因此称为粗捕获码

### P码
- 由两个12级反馈移位寄存器组合产生
- **特点**：
	- 码长长，无法通过与搜索C/A码相同的办法来捕获P码
	- 码元宽度为C/A码的1/10，因此精密度更高（为C/A码的1/10），可以用于较精密的导航定位，称为**精码**
	- 美国政府对P码保密，不供民用

## GPS导航电文
- 是用户用来定位和导航的数据基础。
- 内容主要包括：卫星星历、时钟改正、电离层延迟改正、卫星工作状态信息、由C/A码转换到捕获P码的信息
- 导航电文的信息以二进制码的形式按规定格式组成，并按帧播发给用户。因此又称为**数据码(D码)**

### 导航电文的格式
- 基本单位是“帧”，一帧导航电文长1500bit，包含5个子帧。
- 每个子帧分别含有10个字，每个字含30bit电文。
- 电文播发速率为50bit/s，即每播发一帧电文需要30s时间
- 子帧4、5含有25页，以和25颗GPS卫星的星历对应。子帧1、2、3与子帧4、5的每一页构成一帧电文。故每25帧导航电文组成一个主帧
- 在每一帧电文中，1、2、3子帧的内容每30s重复一次，每小时更新一次；子帧4、5的内容在给卫星注入新的导航数据后更新

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20200105091331220.png" alt="image-20200105091331220" style="zoom:67%;" />

### 导航电文的内容
- **遥测码**：位于各子帧的开头，用于表明卫星注入数据的状态
- **转换码**：位于每个子帧的第二个字码，提供用户从捕获的C/A码转换到捕获P码的Z计数
- **第一数据块**：包括第1子帧的第3~10字码，内容为标识码、时延差改正、星期序号、卫星的健康状况、数据龄期及卫星时钟改正系数
- **第二数据块**：包括2、3两个子帧，内容为GPS卫星星历（开普勒轨道系数、轨道摄动9参数、时间参数）
- **第三数据块**：包括4、5两个子帧，内容为所有GPS卫星的历书数据

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20200105092120217.png" alt="image-20200105092120217" style="zoom:55%;" />

## 伪距测量
- 码相关法伪距测量：通过调整自相关函数 $R(t)$ 的值，来测定测距码由卫星到达测站的传播时间实现
- 自相关函数 $R(t)$ 的值是关于测距码信号传播时间 $\Delta t$ 与 接收机复制码的时间延迟 $\tau$ 之差的函数：
	- $\Delta t-\tau=0$，$R(t)=1$
	- $\Delta t-\tau>t_u$，$R(t)=1/T$，其中 $t_u$ 代表一个码元
	
	<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20200105092225930.png" alt="image-20200105092225930" style="zoom:50%;" />

## 载波相位测量
- 使用专门的高频信号——**载波**调制C/A、P、D码发送：
	- $L_1$ 载波：调制C/A码、P码、导航电文；基准频率的154倍
	- $L_2$ 载波：调制P码、导航电文；基准频率的120倍
	- 基准频率 $f_0=10.23MHz$，C/A码频率是基准频率的1/10，P码频率与基准频率相等 
	
- 接收机 $M$ 内部的振荡器可以产生一个频率和初相完全与卫星 $S$ 发出的信号相同的基准信号，从而计算相位差

- 在起始历元 $t_0$ 进行首次载波相位测量时，所得的像元差包括整周部分 $N_0$ 和不足一个整周部分 $F^0(\phi)$，即
	$$
	\phi ^0(M)-\phi^0(S)=N_0+F^0(\phi)
	$$
	
- 由于载波是一个单纯的正弦波，无法辨识是第几周的相位，故存在**整周未知数** $N_0$ (整周模糊度) 无法直接测定

- 在首次测量后，接收机连续追踪测量卫星信号时，会记录此时的整周数变化值 $In(\phi)$ 和对应的不足一整周数 $F^i (\phi)$，此时：
    $$
    \phi=N_0+\tilde\phi=N_0+In^i(\phi)+F^i(\phi)
    $$
    
- 在卫星信号中断时，会丢失 $In(\phi)$ 中的一部分整周数，称为**整周跳变/周跳**。注意，$F(\phi)$ 是瞬时值，不受周跳影响

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191231092344622.png" alt="image-20191231092344622" style="zoom:80%;" />


## SA政策
- 标准定位业务SPS，精密定位业务PPS
- 即 **Selective Availability / 选择可用性**，限制使用GPS卫星信号，使未经美国政府特许的GPS用户的实时定位精度降低到一个允许的水平，以保护美国自身利益
- SA技术：
	- 对信号基准频率的 $\delta$ 技术：在工作卫星信号基准频率中加入一个**人工高频抖动信号**，使GPS卫星频率产生快速变化（称为钟频抖动）
	- 对导航电文 $\epsilon$ 技术
	- 对P码加密技术
- SA对定位的影响
	- 降低单点精度，广播星历精度由 20m 降低到 100m，且误差是不规则变化的随机量
	- 降低长距离相对定位的精度
	- 增加了高精度相对定位数据处理及整周未知数确定的难度



# 04 GPS定位原理
- 绝对定位使用伪随机码，相对定位使用载波相位法

### GPS测时

- 单站单机测时法
- 共视法：可以消除卫星钟差的影响并明显减弱卫星轨道误差和大气折射误差的影响，故所得相对钟差的精度较高

## GPS绝对定位
- 以地球质心为参考点，确定接收机天线在 WGS-84 坐标系中的绝对位置。
- 定位过程仅需一台接收机，又称为单点定位
- 绝对定位的基本原理：以卫星和接收机天线之间的距离观测量为基准，根据已知的卫星瞬时坐标系，来确定用户接收天线所处的位置
- 绝对定位的实质：空间距离后方交会
- 定位时，在一个测站上需要实时求解4个未知参数（3个点位坐标量+1个钟差参数），因此至少需要4个同步伪距观测量，即**必须同步观测4颗以上卫星**
- **动态绝对定位**：接受设备安置在运动的载体上
- **静态绝对定位**：当接收机天线处于静止状态时，确定观测站绝对位置坐标的方法
- 在GPS静态绝对定位中，定位精度取决于：
	- 单位权中误差 $\delta_0$：由码相关伪距测量的精度、卫星星历精度、大气折射影响等因素确定
	- 未知参数的协因素矩阵 $Q_{T_i}$：由观测卫星的空间几何分布确定

## 卫星几何分布精度因子

- 卫星几何分布精度因子/DOP：用于衡量在GPS导航及定位测量中，观测卫星的空间几何分布对定位精度的影响
- 三维位置精度因子/PDOP
- 钟差精度因子/TDOP
- 垂直分量精度因子/VDOP
- 水平分量精度因子/HDOP
- GPS绝对定位误差与精度因子的大小成正比，在观测精度确定的情况下，应尽量选用精度因子小的一组卫星。这一过程称为选星

## GPS 相对定位

- **静态相对定位**：将两台接收机分别安置在基线的两个端点，其位置静止不动，并同步观测相同的4颗以上的GPS卫星，以确定基线两个端点在协议地球坐标系中的相对位置。
- 静态相对定位精度高（广播星历下10^(-7) ～ 10^(-6)，高于使用码相关伪距测量的绝对定位），但是定位观测的时间也很长（同步跟踪4颗卫星的情况下通常要观测1～1.5小时）
- **动态相对定位**：亦可称作**差分GPS定位**，即使用两台接收机，一台在基准站上固定不动，一台安置在运动的载体上，同步观测相同的卫星，并在观测值之间求差，以消除具有相关性的误差，提高定位精度

### 单差观测
- 不同观测站，同步观测相同卫星所得观测量之差
- 优点：
	- 消除了卫星钟误差的影响
	- 大大削弱了卫星星历误差的影响
	- 大大削弱了对流层折射和电离层折射误差的影响（在短距离内几乎可以完全消除）

### 双差观测
- 不同观测站，同步观测同一组卫星，所得单差观测量之差
- 可以消除**接收机钟差**影响

### 三差观测
- 在不同历元，同步观测一组卫星所得双差观测量之差
- 不含有整周未知数

## 差分GPS
- 根据信息的发送方式可以分为伪距差分、相位差分、位置差分
- 根据基站个数(书中其后的表述为“根据用户站所接受的改正信息形式”)可以分为单基准差分、多基准的局部区域差分、广域差分
- **什么是差分**：由用户接收基准站发送的改正数，并对其测量结果进行改正以获得精密定位的结果

### 伪距差分
- 利用基准站已知坐标求出测站至卫星的距离，并将其与含有误差的测量距离进行比较，利用一个滤波器将此差值滤波并求出其偏差，再将所有卫星的测距误差传输给用户，用户利用此测距误差来改正测量的伪距，进而利用改正后的伪距求出自身的坐标
- 差分定位是利用两站的公共误差的抵消来提高定位精度，随着两站距离的增加，误差公共性逐渐减弱，同时精度逐渐降低

### 位置差分
- 利用安置在已知点上的GPS接收机，对4颗或4颗以上的卫星观测，求出基准站的坐标，并利用基准站以数据链方式发送到用户站的坐标改正数进行改正
- 消除了基准站和用户站的共同误差（卫星星历误差、大气折射误差、卫星钟差、SA政策影响）
- 优点：传输的差分改正数较少，计算方法简单，任何一种GPS接收机都可以改装成这种差分系统
- 缺点：
	- 基准站和用户站必须同步观测同一组卫星，否则会导致定位误差不匹配，影响定位精度
	- 效果不如伪距差分

### 载波相位差分
- **基本原理**：在基准站上安置一台GPS接收机，对卫星进行连续观测，并通过无线电设备实时地将观测数据及测站坐标信息传送给用户；用户站一方面通过接收GPS卫星信号，另一方面通过无线电接收设备接收基站传送的信息，根据相对定位原理进行数据处理，实时地以厘米级精度给出用户站三维坐标
- 优点：精度很高，其噪声误差远远小于测距码测量下的噪声误差
- 缺点：求解整周未知数需要进行1～2h的静止观测，应用范围有限

## 广域差分GPS
### 单基准站差分GPS（SRDGPS）
- **定义**：是根据一个基准站所提供的差分改正信息对用户站进行改正的差分GPS系统
- 该系统由基准站、无线电数据通信链及用户站三部分组成
- **优点**：结构和算法简单
- **缺点**：由于要求用户站误差和基准站误差有较强的相关性，定位精度将随着用户站与基准站之间距离的增加而迅速降低；由于仅根据单个基准站所提供的改正信息来进行定位改正，定位的精度和可靠性都较差（解决方法：设置监控站改正信息进行检核）

### 区域差分GPS系统（LADGPS）
- **定义**：在一个较大的区域布设多个基准站以构成基准站网（其中包含一个或多个监控站），位于该区域中的用户能根据多个基准站提供的改正信息经平差计算后求得用户站定位改正数，这一系统称为区域差分GPS系统
- **优点**：较单基准站差分GPS系统的可靠性和精度均有所提高
- **缺点**：
	- 改正模型设定有误（认为所有的误差对定位的影响特征是相同的，而把各种误差综合在一起进行改正）
	- 由于改正模型有误，只有在用户离基准站不太远时才能获得较好的精度
	- 为保证精度，基准站必须保持一定的密度(小于30km)和均匀度。大面积区域难以覆盖，且部分区域可能无法永久性设站

### 广域差分GPS系统（WADGPS）
- 将观测误差根据来源划分为**星历误差**、**卫星钟差**、**大气折射误差**来进行改正，从而提高精度和可靠性
- **系统构成**：主站、监测站、数据通信链、用户设备
- **优点**：
	- 定位精度与用户站和基准站之间的距离无关
	- 在大区域内建网所需监测站数量少，成本低
	- 具有较均匀的精度分布
	- 可以覆盖到区域差分GPS不易覆盖的区域
- **缺点**：系统使用的硬件设备及通信工具昂贵，软件技术复杂，运行和维持费用远高于区域差分GPS

## 整周未知数的确定方法
 - 静态求解方法
 	- 平差待定参数法
 	- 三差法
 	- 交换天线法
 - 动态求解方法
 	- 最小二乘搜索法
 	- 模糊度函数法
 	- 综合法



# 05 GPS测量的误差来源

## GPS测量误差的分类

|   项目   | 误差来源 | 对距离测量的影响/m |
| :--------: | -------------------------------- | :------------------: |
| 卫星部分 | 星历误差、卫星钟误差、相对论效应 | 1.5~15             |
| 信号传播 | 电离层、对流层、多路径效应         | 1.5~15             |
| 信号接收 | 接收机钟误差、位置误差、天线相位中心变化 | 1.5~5              |
| 其他影响 | 地球潮汐、负荷潮                   | 1.0                |

- 上述误差还可以分为系统误差和偶然误差两类：
    - 偶然误差：卫星信号的多路径效应及观测误差
    - 系统误差：卫星的轨道误差、卫星钟差、接收机钟差、大气折射误差
    - 系统误差远大于偶然误差，是GPS测量的主要误差源
- 系统误差有规律可循，可以采取措施加以消除或减弱：
    - 建立系统误差模型，对观测量进行修正
    - 引入相应的未知参数，同其他未知参数一并求解
    - 将不同观测站对相同卫星进行的同步观测值求差
- **GPS星历误差**：卫星星历所提供的空间位置与实际位置的偏差
    - 对相对定位的影响远小于对单点定位的影响
- **卫星钟误差**：钟差、频偏、频飘以及钟的随机误差
- **相对论效应**：相对运动所带来的时间误差，即是由于卫星钟和接收机钟所处的状态（运动速度和重力位）不同而引起卫星钟和接收机钟之间产生相对钟误差的现象
- **电离层影响**：信号通过电离层时路径弯曲、传播速度变化，使得信号的传播时间乘上真空中光速而得到的距离不等于实际几何距离
    - 可以使用双频接收机或者同步观测来减弱影响
- **对流层影响**：路径发生弯曲，测量距离产生偏差
- **多路径效应**：接收机天线在直接接受卫星信号的同时，还可能接收到天线周围物体或地面反射的卫星信号，两种信号的叠加导致天线相位中心位置的迁移，使观测量产生误差
    - 应选择合适的站址：远离大面积平静水面、测站不宜选择在山坡、山谷和盆地中，应离开高层建筑物
    - 应在天线中设置抑径板
    - 天线应对极化特性不同的反射信号有较强的抑制作用
- **接收机钟差**：在卫星间求一次差即可消除
- **天线相位中心变化**：天线相位中心随着信号输入的强度和方向不同会有所变化，观测时相位中心的瞬时位置与理论上的相位中心将有所不同，导致一定的偏差



# 06 GPS 测量技术与外业施测

## GPS 控制网技术设计的依据

- GPS控制网的技术设计主要是依据GPS测量规范(规程)及测量任务书
- **GPS测量规范(规程)**：是国家质量技术监督局或行业部门所指定的技术标准：
    - 2001年·国家质量技术监督局·国家标准·《全球定位系统(GPS)测量规范》·国标/GB
    - 1992年·国家测绘局·测绘行业标准·《全球定位系统(GPS)测量规范》·《规范》
    - 1998年·建设部·行业标准·《全球定位系统城市测量技术规程》·《规程》
    - 各部委或地区根据本部门GPS工作的实际情况制定的其他GPS测量规程和细则
- **测量任务书**：测量单位上级主管部门或合同甲方下达的技术要求文件（指令性）；规定了测量任务的范围、目的、精度和密度要求，也规定了提交成果资料的项目和时间、完成任务的经济指标
- 在GPS方案设计时，首先依据测量任务书提出的GPS网的精度、点位密度和经济指标，然后结合国家标准或其他行业规程现场，具体确定点位以及点间的连接方式、各点设站观测的次数、时段长短等布网施测方案



## GPS控制网的精度、密度设计

### GPS精度标准及分级

- 按测量精度分为AA、A、B、C、D、E六个级别

| 级别 | 固定误差/(a/mm) | 比例误差系数 | 用途                                                         |
| :--: | :---------------: | :------------: | -------------------------------------------------------- |
|  AA  |       ≤3        |    ≤0.01     | 全球性的地球动力学研究、地壳形变测量、精密定轨               |
|  A   |       ≤5        |     ≤0.1     | 区域性的地球动力学研究和地壳形变测量                         |
|  B   |       ≤8        |      ≤1      | 局部变形监测、各种精密工程测量                               |
|  C   |       ≤10       |      ≤5      | 大、中城市及工程测量的基本控制网                             |
|  D   |       ≤10       |     ≤10      | 中、小城市、城镇及测图、地籍、土地信息、<br />房产、物探、勘测、建筑工地施工测量 |
| E | ≤10 | ≤20 | 同D级 |

- AA级、A级也是建立**地心参考框架**的基础
- AA级、A级、B级也是建立**国家空间大地测量控制网**的基础
- 实际工作中，精度标准的确定要根据用户的实际需要以及人力、物力、财力情况合理设计，也可以参照行业规程和作业经验适当掌握。在具体布设中，可以分级布设，也可以越级布设，或布设同级全面网

### GPS点位的密度标准

- 各级GPS相邻点间**平均距离**应符合下表：

    |   级别   |  AA  |  A   |  B   |   C   |  D   |   E   |
    | :------: | :--: | :--: | :--: | :---: | :--: | :---: |
    | 平均距离 | 1000 | 300  |  70  | 10~15 | 5~10 | 0.2~5 |

- 相邻点**最小距离**可为平均距离的1/3 ~ 1/2，**最大距离**可为平均距离的2 ~ 3倍

## GPS控制网的图形设计

#### 星形网

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191231134548638.png" alt="image-20191231134548638" style="zoom:67%;" />

- 几何图形简单，直接观测边间不                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     构成任何图形
- 作业中只需要两台GPS接收机
- 是一种快速定位作业方式，常用于快速静态定位和准动态定位
- 抗粗差能力极差
- 用于精度较低的工程测量、地质测量、边界测量地籍测量和地形测图等领域
- 在实际布网时需注意：
    - 每点应有一个以上通视方向，以便利用常规测量加密
    - 应该用原有城市坐标系统，并充分利用符合GPS网点要求的旧测绘点
    - GPS网必须构成若干非同步闭合环或附合路线

#### 点连式

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191231135052321.png" alt="image-20191231135052321" style="zoom:67%;" />

- 相邻同步图形之间之间仅由一个公共点连接
- 构成的图形几何强度很弱，没有或极少有非同步图形闭合条件，一般作业中不单独采用

#### 边连式

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191231135626315.png" alt="image-20191231135626315" style="zoom:67%;" />

- 同步图形之间由一条公共基线连接
- 网的几何强度较高，有较多的复测边和非同步图形闭合条件

#### 网连式

- 相邻同步图形之间有两个以上的公共点相连接
- 需要4台以上的接收机
- 几何强度和可靠性指标相当高，但花费的经费和时间也较多，一般仅用于较高精度的控制测量

#### 边点混合连接式

- 将点连式与边连式有机结合，组成GPS网以保证网的几何强度
- 既提高了网的可靠指标，又能减少外业工作量、降低成本

#### 三角锁/多边形连接

<img src="C:\Users\Yorktown\AppData\Roaming\Typora\typora-user-images\image-20191231141845505.png" alt="image-20191231141845505" style="zoom:67%;" />

- 用点连式或边连式组成连续发展的三角锁同步图形
- 适用于狭长地区的GPS布网，如铁路、公路、管线工程勘测等

#### 导线网形连接（环形网）

- 将同步图形设为直伸状，形如导线结构
- 各独立边封闭，形成非同步图形以检核GPS点的可靠性
- 适用于精度较高的GPS布网

## GPS控制网的设计原则

- 在GPS网中不应该存在自由基线（自由基线不构成闭合图形，不具备发现粗差的能力）
- GPS网应按“每个观测至少独立设站观测两次”的原则进行布网
- GPS网中，某一闭合条件下基线类型不宜过多（可能会导致各边粗差在求闭合差时相互抵消，不利于发现粗差，因此网中各点最好有三条以上基线分支）
- 为了实现GPS与原有地面网之间的坐标转换，GPS网应与地面网有2个以上重合点
- 为了便于施测，减少多路径影响，GPS点应选在交通便利，视野开阔的地方，同时应考虑到点与点之间的通视问题，以便使用经典方法进行扩展

## GPS控制网的优化设计
- 在网的精确性、可靠性和经济性等方面，寻求GPS控制网设计的最佳方案

### GPS控制网基准的优化设计
- **位置基准设计**：（以下类型的点可作为位置基准点）
	- 国家坐标系或地方坐标系下的已知点（转化到WGS84下）
	- 已知的Doppler点或SLR(卫星激光测距)点
	- 网中一点的多次GPS伪距观测坐标
- **尺度基准设计**
	- 提供外部尺度基准：边长小于50km的网可用较高精度的测距仪测量2～3条基线边作为整网尺度基准；大型长基线网可以采用SLR站的相对定位观测值和VLBI(甚长基线干涉测量)基线作为GPS网的尺度基准
	- 提供外部尺度基准：网中选一条长基线进行尽可能的长时间、多次观测，然后取平均值作为基准

### GPS网的精度设计
- 可按以下步骤：
	1. 根据布网目的和要求，在图上选点，然后到野外踏勘选点，确保所选点满足本次任务要求和野外观测条件，进而从图上获得待测点位的概略坐标
	2. 根据使用的接收机台数 $m$，取 $m-1$ 条独立基线，作为网的观测图形，并选定网中可能追加施测的基线
	3. 根据精度要求，采用解析-模拟方法，依据精度设计模型，计算网可达到的精度数值
	4. 逐步增减网中独立观测基线个数，直至精度数值达到指标



# 08 GPS卫星信号接收机

## GPS卫星信号接收机的分类
- 按接收机工作原理分
	- **码相关型**：采用码相关技术获得伪距观测量，需要知道伪随机噪声码的结构，又分为C/A码接收机和P码接收机
	- **平方型**：利用载波信号的平方技术去掉调制信号获取载波信号，并通过接收机内产生的载波信号与接收到的载波信号间的相位差测定伪距。不需要知道测距码的结构，因此又被称为无码接收机
	- **混合型**：以上两种的结合体，目前使用的均为此类
- 按接收机的用途分
	- **导航型**：用于确定运动载体的实时位置与速度，主要目的是导航。是一种动态定位，因此只能使用码相关(载波相位会中断)，一般采用C/A码单点实时定位，**精度较低；但结构简单，操作方便，价格便宜**。又可细分为低动态型、中动态型和高动态型
	- **测量型**：用于大地测量和工程测量，一般采用载波相位测量进行相对定位，精度在厘米级甚至更高
		- **实时差分动态定位/RTD**：以伪距观测量为基础，可实时提供流动观测站米级精度的坐标，用于精密导航和海上定位
		- **实时相位差分动态定位/RTK**：以载波相位观测量为基础，可实时提供流动观测站厘米级精度的坐标，用于精密导航、工程测量、三维动态放样、一步法成图
	- **授时型**：主要用于天文台或地面监测站进行时间频标的同步测定
- 按接收的载波频率分
	- **单频接收机**：只能接收 $L_1$ 的载波信号，从而测定载波相位观测值进行定位，一般只用于短基线(<15km)的精密定位
	- **双频接收机**：可以同时接收 $L_1$、$L_2$ 的载波信号。利用双频信号对电离层延迟的不同，可以消除电离层对信号延迟的影响，提高定位精度
- 按通道数分
	- 能够分离同时接收到的不同的多颗卫星的信号的器件称为天线信号通道
	- **多通道接收机**：具有多个信号通道，每个信号通道只连续跟踪一颗卫星信号
	- **序贯通道接收机**：只有一个通道，在相应的软件控制下按时序顺次对卫星信号进行跟踪测量。一个循环周期较长(几秒)，不连续跟踪，且会丢失信息，不能获得完整的导航电文
	- **多路复用通道接收机**：只设一两个通道，在软件控制下按顺序测量卫星信号，只是一个循环的周期相比序贯通道短得多(20ms)，因此可以保持连续跟踪，并同时获得多颗卫星完整的导航电文，但信噪比低于多通道接收机

## GPS接收机的组成
- **天线单元**
	- 要求：
		- 天线与前置放大器密封为一体，以保障正常工作，减少信号损失
		- 能够接收来自天线上半球的卫星信号，不产生死角
		- 有防护和屏蔽多路径效应的措施
		- 保持天线相位中心高度稳定，并与其几何中心尽量一致
- **机主机单元**
	- 信号通道单元
	- 存储单元
	- 计算和显示控制单元
- **电源**
